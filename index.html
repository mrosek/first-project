<html>
  <head>
    <script src='https://cdn.firebase.com/v0/firebase.js'></script>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js'></script>
  </head>
  <body>
  <style type="text/css">
  h1
    {
  text-shadow: 5px 5px 5px #C0C0C0;
  }
  </style>
  <body>

  <h1>Average age of everyone in the office:</h1>

    <div id='messagesDiv' style="border: #000 2px solid; padding: 10px; width: 50%;"></div>
    <input style=" border: #000 1px solid; padding:10px; width: 50%; " type='text' id='nameInput' placeholder='Please enter your name'>
    <input style="border: #000 1px solid; padding: 10px; width: 50%;" type='text' id='ageInput' placeholder='Please enter your birthday (Month/Year)'>
    <script>
    
      
      var myDataRef = new Firebase('https://megan.firebaseio.com/');
      $('#ageInput').keypress(function (e) {
        if (e.keyCode == 13) {
          var age = getAge($('#ageInput').val());
          var name= $ ('#nameInput').val();
          myDataRef.push({age: age, name:name});
          $('#ageInput').val('');
          $('#nameInput').val('');
        } 
      });

      var employees = 0;
      var total_age = 0;

      //I want a callback of average age of everyone entered
    

        myDataRef.on('child_added', function (snapshot) {
        employees += 1;
        total_age += snapshot.val().age;
        average_age = Math.floor(total_age / employees);
        $('#messagesDiv').text(average_age);
      });

      //how to make sure age associated with each name is only counted once . use if function?

      //Convert birthday to age
      function getAge(dateString) {
          var today = new Date();
          var birthDate = new Date(Date.parse(dateString));
          var age = today.getFullYear() - birthDate.getFullYear();
          var m = today.getMonth() - birthDate.getMonth();
          if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
              age--;
          }
          return age;
      }
    </script>
  </body>
</html>